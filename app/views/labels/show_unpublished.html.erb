<%= render 'show_head' %>

<p class="flash_notice">
  <%= t("txt.views.versioning.current_revision") %> <%= @label.rev %><% if @label.locked? %> <%= t("txt.views.versioning.in_ongoing_editing_by") %> <%= @label.locking_user.name %><% end %>
</p>

<div class="editing_versioning_toolbar ui-corner-all ui-widget ui-widget-content">

  <% if (not @label.locked?) || @label.locked_by == @current_user.id %>
  <%= button_to t("txt.views.versioning.publishing"),
          label_versions_merge_path(:origin => @label.origin) %>
  <% end %>
  <%= button_to t("txt.views.versioning.consistency_check"), 
          label_versions_consistency_check_path(:origin => @label.origin), :method => :get %>

  <% if (not @label.in_review?) && @label.locked_by == @current_user.id %>
    <%= button_to t("txt.common.to_review"), label_versions_to_review_path(:origin => @label.origin) %>
  <% end %>

  <% unless @label.locked? %>
    <%= button_to t("txt.views.versioning.to_edit_mode"),
            label_versions_lock_path(:origin => @label.origin) %>
    <%= button_to t("txt.views.versioning.delete"),
            label_path(:published => 0, :id => @label.origin),
            :method => :delete,
            :confirm => I18n.t("txt.views.versioning.delete_confirm") %>
  <% else %>
    <%= button_to t("txt.views.versioning.unlock"),
            label_versions_unlock_path(:origin => @label.origin) if can?(:unlock, @label) %>
    <%= link_to t("txt.views.versioning.edit_mode"),
            edit_label_path(:published => 0, :id => @label.origin),
            :class => "button" if can?(:update, @label) %>
  <% end %>
</div>

<%= render 'layouts/sections', :sections => Iqvoc::XLLabel.view_sections, :data => label_view_data(@label) %>

<%= content_for :sub_navigation do %>
  <ul>
    <li><%= back_link label_path(:id => @label), t('txt.views.navigation.back_to_show') %></li>
  </ul>
<% end %>
